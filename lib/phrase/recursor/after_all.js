// Generated by CoffeeScript 1.6.3
exports.create = function(root, parentControl) {
  var context, notice, stack;
  context = root.context;
  stack = context.stack, notice = context.notice;
  return function(done, injectionControl) {
    var parent, startedAt;
    parent = stack[stack.length - 1];
    if (parent != null) {
      done();
      return process.nextTick(function() {
        return parent.deferral.resolve();
      });
    } else {
      startedAt = context['first walk'].startedAt;
      context['first walk'].duration = Date.now() - startedAt;
      return notice.event('phrase::recurse:end', context['first walk']).then(function() {
        return process.nextTick(done);
      });
    }
  };
};
